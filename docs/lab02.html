<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Lab 2: Data Visualisation I – R for Bio Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./lab03.html" rel="next">
<link href="./lab01.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-bdef442aaf320a139b1684e38e335c71.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./lab00.html">Course Labs</a></li><li class="breadcrumb-item"><a href="./lab02.html">Lab 2: Data Visualisation I</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R for Bio Data Science</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome to R for Bio Data Science</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prologue.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prologue</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./getting_started.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./lab00.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Labs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 1: Course Intro &amp; the Very Basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab02.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Lab 2: Data Visualisation I</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 3: Data Visualisation II</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 4: Data Wrangling I</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 5: Data Wrangling II</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 6: Applying Functional Programming with Purrr to Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 7: Collaborative Bio Data Science using git and GitHub via RStudio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 8: Creating a Simple R-package</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 9 Creating a Simple Shiny Application</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 10 Project Startup &amp; Industry Talks</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./primers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Primers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./primer_linear_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Primer on Linear Models in <code>R</code></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./primer_logistic_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Primer on Logistic Regression in <code>R</code></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./primer_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Primer on Functions in <code>R</code></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./primer_r_packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Primer on R package development</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./primer_paths_and_projects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Paths &amp; Projects</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./primer_variable_assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variable Assignment in <code>R</code></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./guides.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Guides</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./guide_rstudio_server.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Guide for Cloud server and the RStudio IDE</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./guide_working_locally.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Guide for Working Locally</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./guide_building_r4ds2e_locally.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Guide for Building the R4DS2e Book Locally</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./code_styling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Code Styling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./external_resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">External Resources</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./course_elements.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Elements</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ai_in_r4bds.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Use of AI in the R for Bio Data Science Course</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignments</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./project_description.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Project Description</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./project_faq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Project FAQ</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./project_checklist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Project Checklist</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exam.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exam</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#packages" id="toc-packages" class="nav-link active" data-scroll-target="#packages">Package(s)</a></li>
  <li><a href="#schedule" id="toc-schedule" class="nav-link" data-scroll-target="#schedule">Schedule</a></li>
  <li><a href="#learning-materials" id="toc-learning-materials" class="nav-link" data-scroll-target="#learning-materials">Learning Materials</a></li>
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link" data-scroll-target="#learning-objectives">Learning Objectives</a></li>
  <li><a href="#sec-exercises" id="toc-sec-exercises" class="nav-link" data-scroll-target="#sec-exercises">Exercises</a></li>
  <li><a href="#prelude" id="toc-prelude" class="nav-link" data-scroll-target="#prelude">Prelude</a></li>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">Getting Started</a></li>
  <li><a href="#create-data" id="toc-create-data" class="nav-link" data-scroll-target="#create-data">Create data</a></li>
  <li><a href="#ggplot---the-very-basics" id="toc-ggplot---the-very-basics" class="nav-link" data-scroll-target="#ggplot---the-very-basics">ggplot - The Very Basics</a>
  <ul class="collapse">
  <li><a href="#general-syntax" id="toc-general-syntax" class="nav-link" data-scroll-target="#general-syntax">General Syntax</a></li>
  <li><a href="#basic-plots" id="toc-basic-plots" class="nav-link" data-scroll-target="#basic-plots">Basic Plots</a></li>
  <li><a href="#extending-basic-plots" id="toc-extending-basic-plots" class="nav-link" data-scroll-target="#extending-basic-plots">Extending Basic Plots</a></li>
  </ul></li>
  <li><a href="#further-resources-for-data-visualisation" id="toc-further-resources-for-data-visualisation" class="nav-link" data-scroll-target="#further-resources-for-data-visualisation">Further resources for data visualisation</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./lab00.html">Course Labs</a></li><li class="breadcrumb-item"><a href="./lab02.html">Lab 2: Data Visualisation I</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Lab 2: Data Visualisation I</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="packages" class="level2">
<h2 class="anchored" data-anchor-id="packages">Package(s)</h2>
<ul>
<li><a href="https://ggplot2.tidyverse.org">ggplot2</a></li>
</ul>
</section>
<section id="schedule" class="level2">
<h2 class="anchored" data-anchor-id="schedule">Schedule</h2>
<ul>
<li>08.00 - 08.15: <a href="https://raw.githack.com/r4bds/r4bds.github.io/main/pre_course_questionnaire_summary.html">pre-course anonymous questionaire Walk-through</a></li>
<li>08.15 - 08.30: Recap: RStudio Cloud, RStudio and R - The Very Basics (Live session)</li>
<li>08.30 - 09.00: <a href="https://raw.githack.com/r4bds/r4bds.github.io/main/lecture_lab02.html">Lecture</a></li>
<li>09.00 - 09.15: Break</li>
<li>09.00 - 12.00: <a href="#sec-exercises">Exercises</a></li>
</ul>
</section>
<section id="learning-materials" class="level2">
<h2 class="anchored" data-anchor-id="learning-materials">Learning Materials</h2>
<p><em>Please prepare the following materials:</em></p>
<ul>
<li>Book: <a href="https://r4ds.hadley.nz/data-visualize">R4DS2e: Chapter 1 Data Visualisation</a></li>
<li>Paper: <a href="http://vita.had.co.nz/papers/layered-grammar.pdf">“A Layered Grammar of Graphics”</a> by Hadley Wickham</li>
<li>Video: <a href="https://www.ted.com/talks/hans_rosling_the_best_stats_you_ve_ever_seen">The best stats you’ve ever seen</a></li>
<li>Video: <a href="https://www.youtube.com/watch?v=v7WUpgPZzpI">The SDGs aren’t the same old same old</a>, video from the <a href="https://www.gapminder.org">Gapminder foundation</a></li>
<li>Video: EMBL Keynote Lecture - <a href="https://www.youtube.com/watch?v=9YTNYT1maa4">“Data visualization and data science”</a> by Hadley Wickham</li>
<li>Primer: If you are not familiar with working with paths and projects, please read this primer on <a href="primer_paths_and_projects.html">Paths and Projects</a></li>
</ul>
<p><em>Unless explicitly stated, do not do the per-chapter exercises in the R4DS2e book</em></p>
</section>
<section id="learning-objectives" class="level2">
<h2 class="anchored" data-anchor-id="learning-objectives">Learning Objectives</h2>
<p><em>A student who has met the objectives of the session will be able to:</em></p>
<ul>
<li>Explain the basic theory of data visualisation</li>
<li>Decipher the components of a simple ggplot</li>
<li>Use <code>ggplot</code> to do basic data visualisation</li>
</ul>
</section>
<section id="sec-exercises" class="level2">
<h2 class="anchored" data-anchor-id="sec-exercises">Exercises</h2>
</section>
<section id="prelude" class="level2">
<h2 class="anchored" data-anchor-id="prelude">Prelude</h2>
<p><strong>First, make sure you are where you supposed to be, i.e.&nbsp;1. In a group, 2. On Slack, 3. On the RStudio Cloud Server and 4. on Github. If not, see the <a href="./getting_started.html">Getting Started section</a></strong></p>
<p>Then, discuss these 4 visualisations with your group members:</p>
<ul>
<li><em>What is problematic?</em></li>
<li><em>What could be done to rectify?</em></li>
</ul>
<details>
<p>
</p><summary>
Click here for visualisation 1
</summary>
<p></p>
<p><em>Note, AMR = Antimicrobial Resistance</em></p>
<img src="images/bad_viz_09.png" class="img-fluid quarto-figure quarto-figure-center" style="width:80.0%">
</details>
<details>
<p>
</p><summary>
Click here for visualisation 2
</summary>
<p></p>
<img src="images/bad_viz_10.png" class="img-fluid quarto-figure quarto-figure-center" style="width:80.0%">
</details>
<details>
<p>
</p><summary>
Click here for visualisation 3
</summary>
<p></p>
<img src="images/bad_viz_11.png" class="img-fluid quarto-figure quarto-figure-center" style="width:80.0%">
</details>
<details>
<p>
</p><summary>
Click here for visualisation 4
</summary>
<p></p>
<img src="images/bad_viz_12.png" class="img-fluid quarto-figure quarto-figure-center" style="width:80.0%">
</details>
</section>
<section id="getting-started" class="level2">
<h2 class="anchored" data-anchor-id="getting-started">Getting Started</h2>
<p><em>First of all, make sure to read every line in these exercises carefully!</em></p>
<p><em>If you get stuck with Quarto, revisit <a href="https://r4ds.hadley.nz/quarto.html">R4DS2e: Chapter 28 Quarto</a> or <a href="https://quarto.org/docs/guide/">take a look at the Comprehensive guide to using Quarto</a></em></p>
<p><em>If you get stuck working with paths and projects, remember there is a primer to help you, see the preparations materials for this session</em></p>
<ul>
<li><p>Go to the <a href="https://teaching.healthtech.dtu.dk/22100/rstudio.php">R for Bio Data Science RStudio Cloud Server</a> session from last time and log in and choose the project you created.</p></li>
<li><p><strong>Make sure you are working in the right project, check in the upper right corner, it should say <code>r_for_bio_data_science</code></strong></p></li>
<li><p><strong>Create a NEW Quarto Document for today’s exercises, e.g.&nbsp;lab02_exercises.qmd and remember to SAVE it in the same location as your .Rproj-file</strong></p></li>
</ul>
<p>Recall the layout of the IDE (Integrated Development Environment)</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/lab01_04.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
<p>Then, before we start, we need to fetch some data to work on.</p>
<ul>
<li>See if you can figure out how to create a new folder called “data”, make sure to place it the same place as your <code>r_for_bio_data_science.Rproj</code> file.</li>
</ul>
<p>Then, without further ado, run each of the following lines separately in your <em>console</em>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>target_url <span class="ot">&lt;-</span> <span class="st">"https://github.com/ramhiser/datamicroarray/raw/master/data/gravier.RData"</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>output_file <span class="ot">&lt;-</span> <span class="st">"data/gravier.RData"</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>curl<span class="sc">::</span><span class="fu">curl_download</span>(<span class="at">url =</span> target_url, <span class="at">destfile =</span> output_file)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<details>
<p>
</p><summary>
Click here for a hint if you get an error along the lines of <code>Failed to open file...</code>
</summary>
<p></p>
Think about what we are doing here. If you look at the code chunk above, then you can see that we are setting a variable <code>target_url</code>, which defines “a location on the internet”. From here we want to download some data. We need to tell <code>R</code>, where to put this data, so we also define the <code>output_file</code>-variable. Then we call the function <code>curl_download()</code> from the <code>curl</code>-package, hence the notation <code>curl::curl_download()</code>. As arguments to the function-parameters <code>url</code> and <code>destfile</code>, we pass the aforementioned variables. So far so good. Now, look at the <code>target_url</code>- and the <code>output_file</code>-variables, which one of those are we responsible for? If you think about it - We cannot change the <code>target_url</code>, we can only change the <code>output_file</code>, so there is a good chance, that the error you are getting pertains to this variable. But what does the variable contain? It contains the path to where you want to place the file, that is the <code>data/</code>-part and then it contains the filename you want to use, that is the <code>gravier</code>-part and then finally, it contains the filetype you want to use, that is the <code>.RData</code>-part. The filename and filetype is up to you to choose, but the path… Well, <code>R</code> can only find that if it exists… So… Did you remember to create a folder <code>data</code> in the same location as your <code>r_for_bio_data_science.Rproj</code>-file? If this small intermezzo has left things even more unclear, you should go over the primer on <a href="./primer_paths_and_projects.html">paths and projects</a>. Remember, if at first you don’t succeed - Try and try again!
</details>
<ul>
<li>Using the <code>files</code> pane, check the folder you created to see if you managed to retrieve the file.</li>
</ul>
<p>Recall the syntax for a new code chunk:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>  ```{r}</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  #| echo: true</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  #| eval: true</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  # Here goes the code... Note how this part does not get executed because of the initial hashtag, this is called a code-comment</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  1 + 1</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  my_vector &lt;- c(1, 2, 3)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  my_mean &lt;- mean(my_vector)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  print(my_mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>
IMPORTANT! You are mixing code and text in a Quarto Document! Anything within a "chunk" as defined above will be evaluated as code, whereas anything outside the chunks is markdown. You can use shortcuts to insert new code chunks:

- Mac: CMD + OPTION + i
- Windows: CTRL + ALT + i

Note, this might not work, depending on your browser. In that case you can insert a new code chunk using ![](images/insert_new_chunk) or You can change the shortcuts via “Tools” &gt; “Modify Keyboard shortcuts…” &gt; Filter for “Insert Chunk” and then choose the desired shortcut. E.g. change the shortcut for code chunks to Shift+Cmd+i or similar.

- Add a new code chunk and use the `load()` function to load the data you retrieved.

&lt;details&gt;
&lt;p&gt;&lt;summary&gt;Click here for a hint&lt;/summary&gt;&lt;/p&gt;
Remember, you can use `?load` to get help on how the function works and remember your project root path is defined by the location of your `.Rproj` file, i.e. the path. A path is simply where `R` can find your file, e.g. `/home/projects/r_for_bio_data_science/` or similar depending on your particular setup.
&lt;/details&gt;

Now, in the console, run the `ls()` command and confirm, that you did indeed load the `gravier` data.

- Read the information about the `gravier` data [here](https://github.com/ramhiser/datamicroarray/wiki/Gravier-%282010%29)

Now, in your Quarto Document, add a new code chunk like so


::: {.cell}

```{.r .cell-code}
library("tidyverse")</code></pre>
<p>:::</p>
<p>This will load our data science toolbox, including <code>ggplot</code>.</p>
</section>
<section id="create-data" class="level2">
<h2 class="anchored" data-anchor-id="create-data">Create data</h2>
<p>Before we can visualise the data, we need to wrangle it a bit. Nevermind the details here, we will get to that later. Just create a new chunk, copy/paste the below code and run it:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">676571</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>cancer_data<span class="ot">=</span><span class="fu">mutate</span>(<span class="fu">as_tibble</span>(<span class="fu">pluck</span>(gravier,<span class="st">"x"</span>)),<span class="at">y=</span><span class="fu">pluck</span>(gravier,<span class="st">"y"</span>),<span class="at">pt_id=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">pluck</span>(gravier, <span class="st">"y"</span>)),<span class="at">age=</span><span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="fu">length</span>(<span class="fu">pluck</span>(gravier,<span class="st">"y"</span>)),<span class="at">mean=</span><span class="dv">55</span>,<span class="at">sd=</span><span class="dv">10</span>),<span class="dv">1</span>))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>cancer_data<span class="ot">=</span><span class="fu">rename</span>(cancer_data,<span class="at">event_label=</span>y)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>cancer_data<span class="sc">$</span>age_group<span class="ot">=</span><span class="fu">cut</span>(cancer_data<span class="sc">$</span>age,<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">10</span>,<span class="dv">100</span>,<span class="at">by=</span><span class="dv">10</span>))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>cancer_data<span class="ot">=</span><span class="fu">relocate</span>(cancer_data,<span class="fu">c</span>(pt_id,age,age_group,pt_id,event_label))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we have the data set as a tibble, which is an augmented data frame (we will also get to that later):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>cancer_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 168 × 2,909
   pt_id   age age_group event_label    g2E09    g7F07    g1A01   g3C09    g3H08
   &lt;int&gt; &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt;          &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
 1     1  34.2 (30,40]   good        -0.00144 -0.00144 -0.0831  -0.0475  1.58e-2
 2     2  47   (40,50]   good        -0.0604   0.0129  -0.00144  0.0104  3.16e-2
 3     3  60.3 (60,70]   good         0.0398   0.0524  -0.0786   0.0635 -3.95e-2
 4     4  57.8 (50,60]   good         0.0101   0.0314  -0.0218   0.0215  8.68e-2
 5     5  54.9 (50,60]   good         0.0496   0.0201   0.0370   0.0311  2.07e-2
 6     6  58.8 (50,60]   good        -0.0664   0.0468   0.00720 -0.370   2.88e-3
 7     7  52.9 (50,60]   good        -0.00289 -0.0816  -0.0291  -0.0249 -1.74e-2
 8     8  74.5 (70,80]   good        -0.198   -0.0499  -0.0634  -0.0298  3.00e-2
 9     9  47.6 (40,50]   good         0.00288  0.0201   0.0272   0.0174 -7.89e-5
10    10  55.8 (50,60]   good        -0.0574  -0.0574  -0.0831  -0.0897 -1.01e-1
# ℹ 158 more rows
# ℹ 2,900 more variables: g1A08 &lt;dbl&gt;, g1B01 &lt;dbl&gt;, g1int1 &lt;dbl&gt;, g1E11 &lt;dbl&gt;,
#   g8G02 &lt;dbl&gt;, g1H04 &lt;dbl&gt;, g1C01 &lt;dbl&gt;, g1F11 &lt;dbl&gt;, g3F05 &lt;dbl&gt;,
#   g3B09 &lt;dbl&gt;, g1int2 &lt;dbl&gt;, g2C01 &lt;dbl&gt;, g1A05 &lt;dbl&gt;, g1E01 &lt;dbl&gt;,
#   g1B05 &lt;dbl&gt;, g3C05 &lt;dbl&gt;, g3A07 &lt;dbl&gt;, g1F01 &lt;dbl&gt;, g2D01 &lt;dbl&gt;,
#   g1int3 &lt;dbl&gt;, g1int4 &lt;dbl&gt;, g1D05 &lt;dbl&gt;, g1E05 &lt;dbl&gt;, g1G05 &lt;dbl&gt;,
#   g1C05 &lt;dbl&gt;, g1G11 &lt;dbl&gt;, g2D08 &lt;dbl&gt;, g2E06 &lt;dbl&gt;, g3H09 &lt;dbl&gt;, …</code></pre>
</div>
</div>
<ul>
<li><strong>Q1: What is this data?</strong></li>
</ul>
<details>
<p>
</p><summary>
Click here for a hint
</summary>
<p></p>
<em>Where did the data come from?</em>
</details>
<ul>
<li><strong>Q2: How many rows and columns are there in the data set in total?</strong></li>
</ul>
<details>
<p>
</p><summary>
Click here for a hint
</summary>
<p></p>
<em>Do you think you are the first person in the world to try to find out how many rows and columns are in a data set in <code>R</code>?</em>
</details>
<ul>
<li><strong>Q3: Which are the variables and which are the observations in relation to rows and columns?</strong></li>
</ul>
</section>
<section id="ggplot---the-very-basics" class="level2">
<h2 class="anchored" data-anchor-id="ggplot---the-very-basics">ggplot - The Very Basics</h2>
<section id="general-syntax" class="level3">
<h3 class="anchored" data-anchor-id="general-syntax">General Syntax</h3>
<p>The general syntax for a basic <code>ggplot</code> is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> my_data,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> variable_1_name,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> variable_2_name)) <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_something</span>() <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note the <code>+</code> for adding layers to the plot</p>
<ul>
<li><code>ggplot</code> the plotting function</li>
<li><code>my_data</code> the data you want to plot</li>
<li><code>aes()</code> the mappings of your data to the plot</li>
<li><code>x</code> data for the x-axis</li>
<li><code>y</code> data for the y-axis</li>
<li><code>geom_something()</code> the representation of your data</li>
<li><code>labs()</code> the x-/y-labels, title, etc.</li>
</ul>
<p>Now:</p>
<ul>
<li>Revisit this illustration and discuss in your group what is what:</li>
</ul>
<p><img src="images/vis_ggplot_components.png" class="img-fluid"></p>
<p>A very handy <code>ggplot</code> cheat-sheet can be found <a href="https://rstudio.github.io/cheatsheets/data-visualization.pdf">here</a></p>
</section>
<section id="basic-plots" class="level3">
<h3 class="anchored" data-anchor-id="basic-plots">Basic Plots</h3>
<p>Remember to write notes in your Quarto document. You will likely revisit these basic plots in future exercises.</p>
<p>Primer: Plotting 2 x 20 random normally distributed numbers, can be done like so:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">20</span>),</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> <span class="fu">rnorm</span>(<span class="dv">20</span>)),</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lab02_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Using this small primer, the materials you read for today and the <code>cancer_data</code> you created, in separate code-chunks, create a:</p>
<ul>
<li><strong>T1: scatter plot of one variable against another</strong></li>
<li><strong>T2: line graph of one variable against another</strong></li>
<li><strong>T3: box plot of one variable</strong> (<em>Hint: Set <code>x = "my_gene"</code> in <code>aes()</code></em>)</li>
<li><strong>T4: histogram of one variable</strong></li>
<li><strong>T5: densitogram of one variable</strong></li>
</ul>
<p>Remember to write notes to yourself, so you know what you did and if there is something in particular you want to remember.</p>
<ul>
<li><strong>Q4: Do all geoms require both <code>x</code> and <code>y?</code></strong></li>
</ul>
</section>
<section id="extending-basic-plots" class="level3">
<h3 class="anchored" data-anchor-id="extending-basic-plots">Extending Basic Plots</h3>
<ul>
<li><p><strong>T6: Pick your favourite gene and create a box plot of expression levels stratified on the variable <code>event_label</code></strong></p></li>
<li><p><strong>T7: Like T6, but with densitograms</strong> <span style="color: red;">GROUP ASSIGNMENT</span> (Important, see: <a href="./assignments.html">how to</a>)</p></li>
<li><p><strong>T8: Pick your favourite gene and create a box plot of expression levels stratified on the variable <code>age_group</code></strong></p>
<ul>
<li>Then, add stratification on <code>event_label</code></li>
<li>Then, add transparency to the boxes</li>
<li>Then, add some labels</li>
</ul></li>
<li><p><strong>T9: Pick your favourite gene and create a scatter plot of expression levels versus <code>age</code></strong></p>
<ul>
<li>Then, add stratification on <code>event_label</code></li>
<li>Then, add a smoothing line</li>
<li>Then, add some labels</li>
</ul></li>
<li><p><strong>T10: Pick your favourite two genes and create a scatter plot of their expression levels</strong></p>
<ul>
<li>Then, add stratification on <code>event_label</code></li>
<li>Then, add a smoothing line</li>
<li>Then, show split into separate panes based on the variable <code>age_group</code></li>
<li>Then, add some labels</li>
<li>Change the <code>event_label</code> title of the legend</li>
</ul></li>
<li><p><strong>T11: Recreate the following plot</strong></p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lab02_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p><strong>Q5: Using your biological knowledge, what is your interpretation of the plot?</strong></p></li>
<li><p><strong>T12: Recreate the following plot</strong></p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lab02_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p><strong>Q6: Using your biological knowledge, what is your interpretation of the plot?</strong></p></li>
<li><p><strong>T13: If you arrive here and there is still time left for the exercises, you are probably already familiar with <code>ggplot</code> - Use what time is left to challenge yourself to further explore the <code>cancer_data</code> and create some nice data visualisations - Show me what you come up with!</strong></p></li>
</ul>
</section>
</section>
<section id="further-resources-for-data-visualisation" class="level2">
<h2 class="anchored" data-anchor-id="further-resources-for-data-visualisation">Further resources for data visualisation</h2>
<ul>
<li>A very handy <code>ggplot</code> cheat-sheet can be found <a href="https://rstudio.github.io/cheatsheets/data-visualization.pdf">here</a></li>
<li>So which plot to choose? Check this handy <a href="https://www.data-to-viz.com/">guide</a></li>
<li>Explore ways of plotting <a href="https://www.r-graph-gallery.com/">here</a></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./lab01.html" class="pagination-link" aria-label="Lab 1: Course Intro &amp; the Very Basics">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Lab 1: Course Intro &amp; the Very Basics</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./lab03.html" class="pagination-link" aria-label="Lab 3: Data Visualisation II">
        <span class="nav-page-text">Lab 3: Data Visualisation II</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>R for Bio Data Science</p>
</div>   
    <div class="nav-footer-center">
<p>All content © 2023 - 2025 Leon Eyrich Jessen. All rights reserved</p>
</div>
    <div class="nav-footer-right">
<p>Full course description available at <a href="https://kurser.dtu.dk/course/22100">DTU Course Base</a>.</p>
</div>
  </div>
</footer>




</body></html>